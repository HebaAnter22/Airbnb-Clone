<div>
    <app-header></app-header>
</div>

<div class="property-grid">
    <div class="property-card" *ngFor="let property of properties" (click)="goToProperty(property.id)">
      <!-- Image Carousel -->
      <div class="image-container">
        <img *ngIf="(property.images?.length ?? 0) > 0"
             [src]="property.images?.[currentImageIndices[property.id] ?? 0]?.imageUrl ?? 'assets/placeholder.jpg'"
             alt="{{ property.title }}"
             class="property-image" />
        
        <img *ngIf="!property.images?.length"
             src="assets/placeholder.jpg"
             alt="{{ property.title }}"
             class="property-image" />
  
        <!-- Navigation Arrows -->
        <button class="arrow left-arrow" 
                (click)="prevImage(property.id, $event)" 
                *ngIf="(property.images?.length ?? 0) > 1">
          <span class="material-icons">chevron_left</span>
        </button>
        <button class="arrow right-arrow" 
                (click)="nextImage(property.id, $event)" 
                *ngIf="(property.images?.length ?? 0) > 1">
          <span class="material-icons">chevron_right</span>
        </button>
  
        <!-- Guest Favorite Badge -->
        <span class="badge" *ngIf="property.isGuestFavorite">Guest favorite</span>
  
        <!-- Favorite Heart Icon -->
        <button class="favorite" (click)="toggleFavorite(property.id, $event)">
          <span class="material-icons" [class.favorited]="isFavorite(property.id)">
            {{ isFavorite(property.id) ? 'favorite' : 'favorite_border' }}
          </span>
        </button>
  
        <!-- Image Dots -->
        <div class="image-dots" *ngIf="(property.images?.length ?? 0)> 1">
          <span *ngFor="let image of property.images; let i = index"
                [class.active]="i === currentImageIndices[property.id]"></span>
        </div>
      </div>
  
      <!-- Property Details -->
      <div class="property-details">
        <div class="location-rating">
          <span class="location">{{ property.city }}{{ property.country ? ', ' + property.country : '' }}</span>
          <span class="rating" *ngIf="property.averageRating">
            <span class="material-icons star">star</span>
            {{ property.averageRating | number:'1.1-1' }}
          </span>
        </div>
        <div class="price">{{ property.pricePerNight | currency }} night</div>
      </div>
    </div>
  </div>